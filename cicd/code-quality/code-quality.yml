code-quality:
  stage: verify
  needs: ["build-image"]
  image: $CI_REGISTRY_IMAGE:$CI_COMMIT_REF_SLUG-$CI_COMMIT_SHORT_SHA
  tags:
    - dev
  allow_failure: false
  script:
    - cicd/code-quality/code_quality.sh
  artifacts:
    when: always
    paths: [
      report.html,
      /home/node/.npm/_logs/
    ]
  only:
    - branches
  except:
    - tags
